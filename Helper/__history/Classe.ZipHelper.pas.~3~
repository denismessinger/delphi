unit Classe.ZipHelper;

interface

uses
   System.SysUtils, System.Zip, System.IOUtils;

type
  TZipHelper = class helper for TZipFile
    public
      class procedure ZipparArquivos(ArqZipSaida: string; listaArqs: TArray<string>);
  end;

implementation

{ TZipHelper }

class procedure TZipHelper.ZipparArquivos(ArqZipSaida: string; listaArqs: System.TArray<string>);
begin
  DeleteFile(ArqZipSaida);

  var zip: TZipFile := TZipFile.Create;
  try
    zip.Open(ArqZipSaida, zmWrite);

    for var arq: string in listaArqs do
    begin
      zip.Add(arq);
    end;

  finally
    zip.Free;
  end;
end;

end.
